import{r as y,a as b,o as g,w as l,b as k,c as F,d as a,e as w,F as x,i as I,f as c}from"./index-CvEoNkwy.js";import{_ as C}from"./CardList-DP_Cdhda.js";const A="/vue-sneakers/search.svg",B={class:"flex justify-between items-center"},S=a("h2",{class:"text-3xl font-bold mb-8"},"Все кроссовки",-1),Q={class:"flex gap-4"},T=a("option",{value:"name"},"По названию",-1),j=a("option",{value:"price"},"По цене (дешевые)",-1),N=a("option",{value:"-price"},"По цене (дорогие)",-1),$=[T,j,N],V={class:"relative"},E=a("img",{class:"absolute left-4 top-3",src:A,alt:"Search"},null,-1),H={class:"mt-10"},P={__name:"Home",setup(J){const{cart:n,addToCart:d,removeFromCart:u}=I("cart"),s=y([]),r=b({sortBy:"title",searchQuery:""}),v=e=>{e.isAdded?u(e):d(e)},f=async e=>{try{if(e.isFavorite)e.isFavorite=!1,await c.delete(`https://7b6f0b1e26b59458.mokky.dev/favorites/${e.favoriteId}`),e.favoriteId=null;else{const t={item_id:e.id};e.isFavorite=!0;const{data:o}=await c.post("https://7b6f0b1e26b59458.mokky.dev/favorites",t);e.favoriteId=o.id}}catch(t){console.log(t)}},p=e=>{r.sortBy=e.target.value},_=e=>{r.searchQuery=e.target.value},i=async()=>{try{const e={sortBy:r.sortBy};r.searchQuery&&(e.title=`*${r.searchQuery}*`);const{data:t}=await c.get("https://7b6f0b1e26b59458.mokky.dev/items",{params:e});s.value=t.map(o=>({...o,isFavorite:!1,favoriteId:null,isAdded:!1}))}catch(e){console.log(e)}},h=async()=>{try{const{data:e}=await c.get("https://7b6f0b1e26b59458.mokky.dev/favorites");s.value=s.value.map(t=>{const o=e.find(m=>m.item_id===t.id);return o?{...t,isFavorite:!0,favoriteId:o.id}:t})}catch(e){console.log(e)}};return g(async()=>{const e=localStorage.getItem("cart");n.value=e?JSON.parse(e):[],await i(),await h(),s.value=s.value.map(t=>({...t,isAdded:n.value.some(o=>o.id===t.id)}))}),l(n,()=>{s.value=s.value.map(e=>({...e,isAdded:!1}))}),l(r,i),(e,t)=>(k(),F(x,null,[a("div",B,[S,a("div",Q,[a("select",{onChange:p,class:"py-2 px-3 border rounded-md outline-none"},$,32),a("div",V,[E,a("input",{onInput:_,class:"border rounded-md py-2 pl-11 pr-4 outline-none focus:border-gray-400",type:"text",placeholder:"Поиск..."},null,32)])])]),a("div",H,[w(C,{items:s.value,onAddToCart:v,onAddToFavorite:f},null,8,["items"])])],64))}};export{P as default};
